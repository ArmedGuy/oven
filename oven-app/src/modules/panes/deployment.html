<template>
    <div class="ide-panel">
        <h2>Deployment</h2>
        <div if.bind="status">
            <h3>Current status: ${status.StatusDescription}</h3>
            <h5 if.bind="status.Status == 'successful'">
                Available at: <code>http://svchost.ludd.ltu.se/oven/${account.username}/${project.name}</code>
            </h5>
            <div class="ide-row">
                <div class="ide-col">
                    <h2>${status.TaskGroups['www'].HealthyAllocs}<br><small>Healty allocations</small></h2>
                </div>
                <div class="ide-col">
                    <h2>${status.TaskGroups['www'].UnhealthyAllocs}<br><small>Unhealty allocations</small></h2>
                </div>
                <div class="ide-col">
                    <h2>${status.JobVersion}<br><small>Deployment version</small></h2>
                </div>
            </div>
            <h3>Allocations</h3>
            <table class="table table-striped">
                <tr repeat.for="alloc of allocations">
                    <td>${alloc.version}</td>
                    <td>${alloc.name}</td>
                    <td>${alloc.desired}</td>
                    <td>${alloc.status}</td>
                </tr>
            </table>
            <h3>Logs</h3>
            <table class="table table-striped">
                <tr repeat.for="event of events">
                    <td>${event.datetime.toLocaleString()}</td>
                    <td>${event.version}</td>
                    <td>${event.type}</td>
                    <td>${event.message}</td>
                </tr>
            </table>
        </div>
        <div if.bind="!status">
            <h3>No deployment has been made.</h3>
        </div>

        <div class="deploy-button">
            <input type="button" class="btn btn-block" click.trigger="deployProject()" value="Deploy">
        </div>
    </div>
</template>